{% load url from future %}
{% load i18n %}
{% load login_form %}
{% load git_rev_tag %}
<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset=utf-8>
    <title>Magos - Collaborative Game Creation</title>
    <link rel="shortcut icon" href="{{ STATIC_URL }}favicon.ico" />
    <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap.min.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}css/magos.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}css/rateit.css" />

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    {% block extrastyle %}{% endblock %}
</head>
  {% load i18n %}
<body class="{% block bodyclass %}home{% endblock %}">


<div class="container">

    <header>
        <img src="{{ STATIC_URL }}img/magos-logo.png" id="logo">

        <nav id="main-nav" class="group">
            <ul id="main-nav-items">
                <li><a href="/game" class="home">Play</a></li>
                <li><a href="/game/create/" class="create">Create</a></li>
                <li><a href="/game/watch/" class="watch">Watch</a></li>
                {% if not user.is_authenticated %}
                <li><a href="/game/register/" class="register">Register</a></li>
                {% endif %}
            </ul> 
        </nav>
        
        <section id="login-info">
                  {% if not user.is_authenticated %}
                      {% include "apps/game/login_form.html" %}
                  {% else %}
                    <h2>Welcome to Magos</h2>
                    <p>{{ user.first_name }} {{ user.last_name }}<br>[{{ user.username }}]</p>
                    <p>Organisation: {{ user.userprofile.organization }}</p>
                    <p><a id="logout" class="navbar-link" href="{% url 'logout_user'%}">{% trans "Logout" %}</a></p>
                  {% endif %}
        </section>

    </header>


    <section id="content" class="group">
        {% block content %}{% endblock %}
    </section>
</div>


<div class="bottom-shadow"></div>

<div id="footer_wrapper">
    <footer>
        <img src="{{ STATIC_URL }}img/magos-wiz-bottom.png" id="bottom-wiz">

        <section id="footer-left">
            <img id="magos-logo-footer" src="{{ STATIC_URL }}img/magos-logo-footer.png">
        </section>
        
        <nav id="footer-nav">
            <ul id="footer-nav-items">
                <li><a href="/game" class="home">Play</a></li>
                <li><a href="/game/create/" class="create">Create</a></li>
                <li><a href="/game/invent/" class="invent">Invent</a></li>
                <li><a href="/game/watch/" class="watch">Watch</a></li>
                <li><a href="#" class="explore">Explore</a></li>
            </ul>
        </nav>

        <div class="footer-wide">
            <p>&copy; Copyright 2012-2013 Magical project. <br /><span class="version-info">Version info: {% git_rev_tag %}</span></p>
        </div>

    </footer>
</div>

    <script src="{{ STATIC_URL }}js/lib/jquery-1.7.1.min.js"></script>
    <script src="{{ STATIC_URL }}js/lib/underscore-min.js"></script>
    <script src="{{ STATIC_URL }}js/lib/jquery.blockUI.js"></script>
    <script src="{{ STATIC_URL }}js/lib/noty/jquery.noty.js"></script>
    <script src="{{ STATIC_URL }}js/lib/noty/layouts/top.js"></script>
    <script src="{{ STATIC_URL }}js/lib/noty/themes/default.js"></script>
    <script src="{{ STATIC_URL }}js/lib/bootstrap.min.js"></script>
    <script src="{{ STATIC_URL }}js/lib/bootbox.min.js"></script>
    <script src="{{ STATIC_URL }}js/jquery.rateit.min.js"></script>
    <script src="{{ STATIC_URL }}js/csrf.js"></script>
    <script src="{{ STATIC_URL }}js/magos-public.js"></script>
    <script type="text/javascript">
        $(document)
	    .ajaxStart(function() {
	    	$.blockUI({ 
	    		message: '<img id="ajax_loader" style="width:120px;height:15px;vertical-align:middle;margin:30px 8px 10px 8px;" src="{{ STATIC_URL }}img/ajax-loader.gif" /><h1 class="ajax-loading">Loading...</h1>',
	    		css : { border : 'none' }
	    	}); 
	        //$(this).show();
	    })
	    .ajaxStop(function() {
	    	$.unblockUI();
	        //$(this).hide();
	    });

        {% if messages %}
            {% for message in messages %}            
                App.games.notify('{{ message }}', 'success');
            {% endfor %}
        {% endif %}        

        $(document).ready(function() {
            function redirectToLogin() {
                window.location.href = '{{ login_url }}';
            }
        });
        
    </script>
    {% block extrajs %}{% endblock %}
  </body>
</html>
