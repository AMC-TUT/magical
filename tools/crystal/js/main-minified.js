function convertToRGB(e){e=e.charAt(0)=="#"?e.substring(1,7):e;var t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return"rgb("+t+","+n+","+r+")"}function convertToRGBArray(e){function n(e){var n=parseInt(e,16);t.push(n)}var t=new Array;return e=e.charAt(0)=="#"?e.substring(1,7):e,n(e.substring(0,2)),n(e.substring(2,4)),n(e.substring(4,6)),t}$(document).ready(function(){function l(e){arguments.length==0||e?$("#crystalBallLens").mousedown(function(){c(),$("#contentHolder").text(""),console.log("mousemove"),$("#crystalBall").mousemove(function(){g()}),$("body").mouseup(function(){h()})}):h()}function c(){var e=$("#crystalBallLens").width(),t=[0,0,window.innerWidth-e,window.innerHeight-e];$("#crystalBall").draggable({handle:"#crystalBallLens",containment:t}),m()}function h(){$("#crystalBall").unbind("mousemove"),$("#crystalBall").draggable("destroy")}function p(e){arguments.length==0||e?d():(window.removeEventListener("devicemotion",v),s=null)}function d(){o=null,s=window.addEventListener("devicemotion",v,!0)}function v(e){o==null&&m();var t=6,n=Math.sqrt(e.accelerationIncludingGravity.x*e.accelerationIncludingGravity.x+e.accelerationIncludingGravity.y*e.accelerationIncludingGravity.y);o=new Object({x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y}),n>=t&&g()}function m(){if(i==null){$("#contentHolder").text(""),b(100,"1,-2,0");if(r){var e=5,t=0,n,s="";for(var o=0;o<u.length;o++){var f=u[o]-a[o],l=f>=0?Math.ceil(f/e):Math.floor(f/e);s+=l+(o<u.length?",":"")}n=setInterval(c,100);function c(){t<e?(w(s),t++):(r=!1,window.clearInterval(n))}}}}function g(){var e=100;r||(w("-1,2,0"),n++),n>e&&(y(),n=0)}function y(){var n=["verbs","nouns","adjectives"],i=e[n[t]],s=i[Math.floor(Math.random()*i.length)].word;$("#contentHolder").text(s),t=t==n.length-1?0:t+1,b(-1),r=!0,f?setTimeout(d,2e3):h(),E(!0)}function b(e,t){function r(){n=Math.max(n-1,0),w(t)}i!=null&&(window.clearInterval(i),i=null);if(arguments.length==2||e>0)i=setInterval(r,e)}function w(e){var t=arguments[0]==null?[0,0,0]:e.split(","),n="rgb(";for(var r=0;r<t.length;r++)a[r]+=parseInt(t[r]),a[r]=Math.min(Math.max(0,a[r]),255),n+=a[r]+(r<t.length-1?",":"");n+=")";var i=document.getElementById("crystalBallCanvas"),s=i.getContext("2d");s.clearRect(0,0,i.width,i.height),s.beginPath(),s.arc(i.width/2,i.height/2,i.width/2,0,Math.PI*2,!0),s.closePath(),s.fillStyle=n,s.fill()}function E(e){var t=$("#crystalBall"),n=$("#crystalBallLens").width(),r=(window.innerWidth-n)/2,i=(window.innerHeight-n)/2;if(arguments.length==0||!e)t.css("left",r+"px"),t.css("top",i+"px");else{var s=Math.sqrt(Math.pow(t.position().left-r,2)+Math.pow(t.position().top-i,2))*2;s=Math.max(s,1e3),t.animate({left:r,top:i},s,"easeOutElastic")}h()}var e,t=0,n=0,r=!1,i,s,o,u=convertToRGBArray("#FF00FF"),a=u.slice(0),f=window.DeviceMotionEvent==undefined||window.DeviceMotionEvent.interval==undefined;f=!1,$.getJSON("words.json",function(t){e=t,w()}),E(),f?p():l()});