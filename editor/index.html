<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Magos Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Magical">
  <link href="/static/css/main.css" rel="stylesheet">
  <link id="theme" href="/static/css/dark.css" rel="stylesheet">
</head>

<body>

  <script type="text/x-handlebars">
  <div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
  <div class="container-fluid">

  {{#view App.TitleView}} {{title}} {{/view}}

  <div class="btn-toolbar general-toolbar pull-right">

    <div class="btn-group">
      <button class="btn btn-info btn-grid active"><i class="icon-th icon-white"></i></button>
    </div>

    <div class="btn-group">
      <button class="btn btn-info btn-magosbook"><i class="icon-book icon-white"></i></button>
    </div>

    <div class="btn-group">
      <button class="btn btn-info btn-gameinfo"><i class="icon-info-sign icon-white"></i></button>
    </div>

    <div class="btn-group btn-group-theme">
      <a class="btn btn-info" data-theme="light" href="#">Light</a>
      <a class="btn btn-info active" data-theme="dark" href="#">Dark</a>
    </div>

    {{#view App.LanguageSelectionView class="btn-group btn-group-language"}}

    <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
      <img {{bindAttr src="content.flag"}} />&nbsp;&nbsp;<span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
    {{#each App.languagesController}}
      {{#view App.LangList tagName="li" languageBinding="this"}}
      <a href="#"><img {{bindAttr src="language.flag"}} class="icon-flag">&nbsp;&nbsp;{{language.title}}</a>
      {{/view}}
    {{/each}}
    </ul>
    {{/view}}

    <div class="btn-group btn-group-help">
      <button class="btn btn-warning"><i class="icon-question-sign icon-white"></i></button>
    </div>

    </div>

    <div class="btn-toolbar pull-right game-toolbar">

      <div class="btn-group btn-group-scene">
      {{#each App.scenesController}}
        {{#view App.SelectSceneBtn tagName="button" sceneBinding="this"}}
          {{scene.name}}
        {{/view}}
      {{/each}}
      </div>

      <div class="btn-group btn-group-preview help-popover" data-placement="bottom" title="Preview" data-content="Play your game as it is now. Use this to test that everything works the way you wanted.">
        <button class="btn btn-success btn-preview">Preview</button>
      </div>

      {{#view App.PublishedView}}
        <button {{bindAttr class="privateState:active alwaysTrue:btn alwaysTrue:btn-success"}}>Public</button>
        <button {{bindAttr class="publicState:active alwaysTrue:btn alwaysTrue:btn-success"}}>Private</button>
      {{/view}}

      </div>

    </div>
  </div>
  </div>
  </script>

  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span9 sortable-mainarea">

      <script type="text/x-handlebars">
      <div class="row-fluid canvas-container">
        <div class="canvas well">

          <!-- intro -->
          <div class="canvas-pane canvas-div canvas-intro"></div>

          <!-- table -->
          <table class="canvas-pane canvas-table canvas-game" style="display:none;"></table>

          <!-- outro -->
          <div class="canvas-pane canvas-div canvas-outro" style="display:none;"></div>

        </div><!-- canvas well -->
      </div>
      </script>

      <script type="text/x-handlebars">
        <div class="row-fluid">

          <div class="span3 chest-container scene-chest-container">
            <ul class="chest scene-chest">
              {{#each App.sceneComponentsController}}
                {{#view App.SceneComponentsView tagName="li" itemBinding="this" classNameBindings="uiSelected"}}
                <img {{bindAttr class="item.active item.potionsStr item.scenesStr alwaysTrue:scene-item"}} {{bindAttr src="item.icon"}} {{bindAttr alt="item.title"}} {{bindAttr title="item.title"}} {{bindAttr data-slug="item.slug"}} /></li>
                {{/view}}
              {{/each}}
            </ul>
            <div class="clearfix"></div>
          </div>

          <div class="span9 chest-container game-container">
            <ul class="chest item-chest">
              {{#each App.gameComponentsController}}
                {{#view App.GameComponentsView tagName="li" itemBinding="this" classNameBindings="uiSelected"}}
                <img class="game-item" {{bindAttr class="item.active"}} {{bindAttr src="item.icon"}} {{bindAttr alt="item.title"}} {{bindAttr title="item.title"}} {{bindAttr data-slug="item.slug"}} /></li>
                {{/view}}
              {{/each}}

              {{#view App.AddGameComponentView tagName="li" itemBinding="this" class="add-item" title="Add New Item"}}
                <img class="action-item" src="/static/img/components/add.png" alt="Add New Item" title="Add New Item">
              {{/view}}

              {{#view App.RemoveGameComponentView tagName="li" itemBinding="this" class="remove-item" title="Remove Item"}}
                <img class="action-item" src="/static/img/components/trash.png" alt="Remove Item" title="Remove Item">
              {{/view}}

            </ul>
            <div class="clearfix"></div>
          </div>

        </div>
      </script>

      <script type="text/x-handlebars">
      {{! InfoBox }}
      <div class="magos-infobox well">
        <div class="navbar">
          <div class="navbar-inner navbar-inner-in-well">
            <div class="container">

              <a class="btn btn-navbar" data-toggle="collapse" data-target=".infobox-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>

              <h3 class="sortable-handle">Element Information</h3>

              <div class="nav-collapse infobox-collapse">

                <div class="row-fluid">

                  <div class="span4 infobox-span">

                    <div class="infobox-skillset infobox-physicus">

                      <h4>Controls</h4>

                      {{#view App.InfoBoxControlsView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-controls"}}
                        <tr>
                          <td>
                            Method
                          </td>
                          <td>
                          {{#if content.properties.controls.method}} {{content.properties.controls.method}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                        <tr>
                          <td>Speed</td>
                          <td>
                          {{#if content.properties.controls.speed}} {{content.properties.controls.speed}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                        <tr>
                          <td>Jump Height</td>
                          <td>
                          {{#if content.properties.controls.jumpHeight}} {{content.properties.controls.jumpHeight}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                        <tr>
                          <td>Snap to Grid</td>
                          <td>
                          {{#if content.snapToGrid}} {{content.snapToGrid}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                      {{/view}}

                      <h4>Collision</h4>
                      {{#view App.InfoBoxCollisionView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-collision"}}
                      <tr>
                        <th>Target</th><th>Action</th>
                      </tr>

                      {{#if content.properties.collisions}}
                        {{#each content.properties.collisions}}
                        <tr>
                          <td>
                            {{#if target}} {{target}} {{else}} ---{{/if}}
                          </td>
                          <td>
                            {{#if event}} {{event}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                        {{/each}}
                      {{else}}
                        <tr><td> ---</td><td> ---</td></tr>
                      {{/if}}
                      {{/view}}

                      <h4>Gravitation</h4>
                      {{#view App.InfoBoxGravitationView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-gravitation"}}
                        <tr>
                          <td>Strength</td>
                          <td>
                            {{#if content.properties.gravitation.strength}} {{content.properties.gravitation.strength}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                        <tr>
                          <td>Direction</td>
                          <td>
                          {{#if content.directionStr}} {{content.directionStr}} {{else}} ---{{/if}}
                          </td>
                        </tr>
                      {{/view}}

                    </div>
                  </div><!--/span-->

                  <div class="span4">

                    <div class="infobox-skillset infobox-principes">

                      <h4>Score</h4>
                      {{#view App.InfoBoxScoreView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-score"}}
                        <tr>
                          <th>Action</th><th>Score</th>
                        </tr>
                        {{#if content.filteredScoreEvents}}
                        {{#each content.filteredScoreEvents}}
                          <tr>
                            <td>Collision {{target}}</td><td>{{score}}</td>
                          </tr>
                        {{/each}}
                        {{else}}
                          <tr><td> ---</td><td> ---</td></tr>
                        {{/if}}
                      {{/view}}

                      <h4>Font</h4>
                      {{#if App.selectedComponentController.content.properties.font}}
                      {{#view App.InfoBoxFontView}}
                        <div {{bindAttr style="cssBgColor"}}>
                          <div {{bindAttr style="cssColor"}}>
                            <div {{bindAttr style="cssSize"}}>
                              <div {{bindAttr style="cssFamily"}}>
                                {{family}}
                              </div>
                            </div>
                          </div>
                        </div>
                      {{/view}}
                      {{else}}
                        <div class="font-preview empty"> ---</div>
                      {{/if}}

                      <h4>Dialog</h4>
                      {{#view App.InfoBoxDialogView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-dialog"}}
                        <tr>
                          <th>Action</th><th>Participants</th>
                        </tr>
                        <tr><td> ---</td><td> ---</td></tr>
                      {{/view}}

                      <h4>Text</h4>
                      {{#view App.InfoBoxTextView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-text"}}
                        <tr>
                          <th>Action</th><th>Text</th>
                        </tr>
                        {{#if content.filteredTextEvents}}
                        {{#each content.filteredTextEvents}}
                          <tr>
                            <td>Collision {{target}}</td><td class="ellipsis">{{text.text}}</td>
                          </tr>
                        {{/each}}
                        {{else}}
                          <tr><td> ---</td><td> ---</td></tr>
                        {{/if}}
                      {{/view}}

                    </div>
                  </div><!--/span-->

                  <div class="span4">

                    <div class="infobox-skillset infobox-artifex">

                      <h4>Image</h4>
                      {{#view App.InfoBoxSpriteView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-sprite"}}
                        <tr>
                          <td colspan"2">
                           {{#if content.icon}} <img {{bindAttr src="content.icon"}} class="sprite"> {{else}} ---{{/if}}
                          </td>
                        </tr>
                      {{/view}}

                      <h4>Animation</h4>
                      {{#view App.InfoBoxAnimationView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-animation"}}
                        <tr>
                          <th>Action</th><th>Animation</th>
                        </tr>
                        <tr>
                          <td> ---</td><td> ---</td>
                        </tr>
                      {{/view}}

                    </div>

                    <div class="infobox-skillset infobox-musicus">

                      <h4>Audio</h4>

                      {{#view App.InfoBoxAudioView contentBinding="App.selectedComponentController.content" tagName="table" class="table infobox infobox-audio"}}
                        <tr>
                          <th>Action</th><th>Audio</th><th>Plays</th>
                        </tr>

                        {{#if content.filteredAudioEvents}}
                        {{#each content.filteredAudioEvents}}
                          <tr>
                            <td>
                              {{event}}
                            </td>
                            <td>
                              <audio>
                                <source src="/static/game/audios/ogg/boom.ogg" type="audio/ogg" />
                              </audio>
                              <button class="btn btn-success btn-mini btn-play"><i class="icon-play icon-white"></i></button>
                            </td>
                            <td>
                              {{audio.playCount}}
                            </td>
                          </tr>
                        {{/each}}
                        {{else}}
                          <tr><td> ---</td><td> ---</td><td> ---</td></tr>
                        {{/if}}
                      {{/view}}

                    </div>
                  </div><!--/span-->

                  <div class="clearfix"></div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      </script>

      <script type="text/x-handlebars">
      {{! ShoutBox }}
        <div class="magos-shoutbox well">
          <div class="navbar">
            <div class="navbar-inner navbar-inner-in-well">
              <div class="container">

                <a class="btn btn-navbar" data-toggle="collapse" data-target=".shoutbox-collapse">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </a>

                <h3 class="sortable-handle">Shoutbox</h3>

                <div class="nav-collapse shoutbox-collapse">
                  <div class="magos-shoutbox-log">
                    <table>
                      {{#view App.ShoutsView}}
                        {{#each content}}
                          <tr {{bindAttr class="magos" }}>
                            <td>{{time}}</td><td>{{firstName}}</td><td>{{message}}</td>
                          </tr>
                        {{/each}}
                      {{/view}}
                    </table>
                  </div>

                  {{#view App.ShoutForm controllerBinding="App.shoutsController"}}
                    {{view Ember.TextField type="text" class="input" viewName="textField" placeholder="Shout"}}
                    <button type="submit" class="btn btn-info">Shout</button>
                  {{/view}}

                </div>
              </div>
            </div>
          </div>
        </div>
      </script>

      </div><!--/ left side-->

      <div class="span3">
          <script type="text/x-handlebars">
          {{#view App.MagosView}}
            {{#each content}}
              <div class="sortable-item well">
              {{#if user}}
                <h3 class="sortable-handle">{{user.firstName}}</h3>

                {{#if user.busy}}
                  <img src="/static/img/icons/busy.png" class="busy-icon" title="User is busy right now" />
                {{else}}
                  <img src="/static/img/icons/available.png" class="busy-icon" title="You can change the roles with the user" />
                {{/if}}

              {{else}}
                <h3 class="capitalize sortable-handle">{{magos}}</h3>
                <img src="/static/img/icons/available.png" class="busy-icon" title="You can change the roles with the user" style="opacity: 0.4;" />
              {{/if}}

              <div {{bindAttr class="magos:magos-potions magos activeUser:selected-magos"}}>
                  <img class="magos-icon inner-shadow draggable-item" {{bindAttr src="icon"}} alt="" />
                  <table class="table">
                    <tbody>
                      {{#each potions}}
                      <tr>
                        <td>
                          <img class="potion-icon inner-shadow draggable-item" {{bindAttr data-potion="title"}} src="/static/img/icons/potion.png" {{bindAttr alt="title"}} />
                        </td>
                        <td class="capitalize">
                          {{title}}
                        </td>
                      </tr>
                      {{/each}}
                    </tbody>
                  </table>
                </div>

                {{#if activeUser}}

                {{! Score}}

                <div {{bindAttr class="magos:magos-potions magos magos:score magos:hide"}} style="display:none;">
                <form class="form-vertical">
                  <fieldset>
                    <legend>Scores</legend>

                    {{#if App.selectedComponentController.content.filteredScoreEvents}}
                    {{#each App.selectedComponentController.content.filteredScoreEvents}}
                      {{#view App.MagosComponentPropertyView contentBinding="this"}}
                      <div class="action-group">
                        <div class="control-group">
                          <button {{action "removeComponentProperty"}} class="btn btn-danger btn-del-action pull-right"><i class="icon-minus icon-white"></i></button>
                          <label class="control-label">Action</label>
                          <div class="controls">
                            <select class="span12" disabled="disabled">
                              <option>Collision {{content.target}}</option>
                            </select>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">Score</label>
                          <div class="controls">
                            {{view App.NumberField class="input" min="-1000" max="1000" valueBinding="content.score"}}
                          </div>
                        </div>
                      </div>
                      {{/view}}
                    {{/each}}

                    {{else}}
                      <div class="action-group">
                        <div class="control-group">
                          <label class="control-label">Action</label>
                          <div class="controls">
                            <select class="span12">
                              <option>---</option>
                            </select>
                          </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">Score</label>
                          <div class="controls">
                            {{view App.NumberField class="input" min="-1000" max="1000" valueBinding="score"}}
                          </div>
                        </div>
                      </div>
                    {{/if}}

                    <div class="form-actions">
                      <button class="btn btn-info btn-back-potion"><i class="icon-arrow-left icon-white"></i></button>
                      <button class="btn btn-success btn-add-action pull-right"><i class="icon-plus icon-white"></i></button>
                    </div>

                    </fieldset>
                  </form>
                </div>

                  {{/if}}

              </div>
            {{/each}}

          {{/view}}

          </script>
        </div><!--/ sortable area -->
      </div><!--/ right span -->

    </div>

    <hr>

    <footer>
      <p>&copy; Magical 2012</p>
    </footer>

  </div>

  <!-- preview -->
  <script type="text/x-handlebars">
  <div class="modal fade hide" id="dialog-preview">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">×</button>
      <h3>Game Preview</h3>
    </div>
    <div class="modal-body">
      <iframe id="preview" src="/game/super-magos" seamless></iframe>
    </div>
    <div class="modal-footer">
      <button class="btn btn-info btn-close" type="submit">Close</button>
    </div>
  </div>
  </script>

  <!-- info -->
  <script type="text/x-handlebars">
  <div class="modal fade hide" id="dialog-info">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">×</button>
      <h3>Game Info</h3>
    </div>
    <div class="modal-body">
      <p>Snippet: Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
          consequat.</p>
      <p>Duis aute irure dolor in reprehenderit in voluptate velit esse
          cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
          proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-info btn-close" type="submit">Close</button>
    </div>
  </div>
  </script>

  <!-- add new item -->
  <script type="text/x-handlebars">
  <div class="modal fade hide" id="dialog-new-item">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">×</button>
      <h3>Add New Item</h3>
    </div>
    {{#view App.AddItemForm}}
    <div class="modal-body">
        <fieldset>
          <div class="control-group" style="margin-bottom: 0;">
            <label class="control-label" style="font-weight:bold;" for="input01">Give item some descriptive name</label>
            <div class="controls">
              {{view Ember.TextField valueBinding="itemTitle" class="input-xlarge" placeholder="Item Name"}}
              <p class="help-block">Notice! Every item must have an unique name!</p>
            </div>
          </div>
        </fieldset>
    </div>
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal">Cancel</button>
      <button class="btn btn-success" type="submit">Add Item</button>
    </div>
    {{/view}}
  </div>
  </script>

  <script type="text/javascript">
  ENV = {
    CP_DEFAULT_CACHEABLE: true,
    // VIEW_PRESERVES_CONTEXT: true,
    RAISE_ON_DEPRECATION: true
  };
  </script>
  <script src="/static/js/vendor/jquery.min.js"></script>
  <script src="/static/js/vendor/jquery-ui.min.js"></script>
  <script src="/static/js/vendor/bootstrap.min.js"></script>
  <script src="/static/js/vendor/ember.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="/static/js/plugins.js"></script>
  <script src="/static/js/main.js"></script>

</body>
</html>
